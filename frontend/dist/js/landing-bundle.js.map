{"version":3,"file":"js/landing-bundle.js","sources":["webpack:///src/landing.js","webpack:///src/apps/landing/containers/subscription.js","webpack:///./src/styles/subscription.less?8796","webpack:///./src/styles/subscription.less","webpack:///src/helpers/utils.js"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './axios_defaults';\nimport Subscription from 'apps/landing/containers/subscription';\n\n\nReactDOM.render(<Subscription/>, document.getElementById('react-subscription'));\n\n\n\n// WEBPACK FOOTER //\n// src/landing.js","import 'styles/subscription.less';\nimport React, {Component} from 'react';\nimport {Form, Text} from 'react-form';\nimport autoBind from 'react-autobind';\nimport cx from 'classnames';\n\nimport {Button} from 'common/components/buttons';\nimport {DoubleBounceSpinner} from 'common/components/spinners';\nimport {validateEmail} from 'helpers/validators';\nimport {post} from 'helpers/rest';\nimport {getQueryParams} from 'helpers/utils';\n\n\nexport default class Subscription extends Component {\n    constructor(props) {\n        super(props);\n        autoBind(this);\n        this.state = {\n            submitSuccess: false,\n            alreadySubscribed: false,\n            submitPending: false,\n            submitErrors: {email: null},\n            unsubscribeSuccess: false,\n            unsubscribeError: ''\n        };\n        this._token = getQueryParams().token;\n    }\n\n    validateError(values) {\n        this.setState({submitErrors: {email: null}});\n        if (!values.email) {\n            return {email: gettext('Please type your email.')};\n        } else if (!validateEmail(values.email)) {\n            return {email: gettext('Oops... There\\'s a mistake. Please type a valid email.')};\n        }\n        return {email: null};\n    }\n\n    onSubmit(values) {\n        this.setState({\n            submitSuccess: false,\n            submitPending: true\n        });\n        post('subscriptions/', values)\n            .then(response => {\n                this.setState({\n                    submitSuccess: true,\n                    submitPending: false,\n                    alreadySubscribed: response.data.already_subscribed\n                });\n            })\n            .catch(error => {\n                let message = gettext('Oops! Something went wrong. Please try again in a moment.');\n                if (error.response && error.response.data.email) {\n                    message = error.response.data.email[0];\n                }\n                this.setState({\n                    submitPending: false,\n                    submitErrors: {email: message}\n                });\n            });\n    }\n\n    unsubscribe() {\n        this.setState({submitPending: true});\n        post('subscriptions/unsubscribe/', {token: this._token})\n            .then(() => {\n                this.setState({\n                    unsubscribeSuccess: true,\n                    submitPending: false\n                });\n            }).catch(error => {\n                let message = gettext('Oops! Something went wrong. Please try again in a moment.');\n                if (error.response && error.response.data.detail) {\n                    message = error.response.data.detail;\n                }\n                this.setState({\n                    submitPending: false,\n                    unsubscribeError: message\n                });\n            });\n    }\n\n    renderForm() {\n        return (\n            <div className={cx('subscription-form', {'hidden': this.state.submitSuccess || this.state.submitPending})}>\n                <h5>\n                    {gettext('Get notified when it\\'s ready')}\n                </h5>\n                <Form\n                    onSubmit={this.onSubmit}\n                    validateError={this.validateError}\n                    dontValidateOnMount={true}\n                    validateOnSubmit={true}\n                >\n                    {formApi => {\n                        return (\n                            <form onSubmit={formApi.submitForm}>\n                                <div className={'inputs'}>\n                                    <Text\n                                        field=\"email\"\n                                        name={'email'}\n                                        className={'grow'}\n                                        placeholder={'Email'}\n                                    />\n                                    <Button type={'submit'}>\n                                        {gettext('Subscribe')}\n                                    </Button>\n                                </div>\n                                <div className={'error'}>\n                                    {formApi.errors.email}\n                                    {this.state.submitErrors.email}\n                                </div>\n                            </form>\n                        );\n                    }}\n                </Form>\n            </div>\n        );\n    }\n\n    renderUnsubscribe() {\n        if (this.state.unsubscribeError) {\n            return <div className={'error'}>{this.state.unsubscribeError}</div>;\n        }\n        return (\n            <div className={cx('unsubscribe', {'hidden': this.state.unsubscribeSuccess || this.state.submitPending})}>\n                <h5>{gettext('Are you sure that you want to unsubscribe?')}</h5>\n                <span onClick={this.unsubscribe}>\n                    <Button>{gettext('Yes, I\\'m sure')}</Button>\n                </span>\n            </div>\n        );\n    }\n\n    render() {\n        return (\n            <div className={'subscription'}>\n                {this.state.submitSuccess && !this.state.alreadySubscribed &&\n                <h4>{gettext('You were subscribed successfully!')}<br/>{gettext('See ya!')}</h4>}\n                {this.state.submitSuccess && this.state.alreadySubscribed &&\n                <h4>{gettext('Looks like you are already subscribed.')}<br/>\n                    {gettext('Thank you for being with us!')}</h4>}\n                {this.state.unsubscribeSuccess &&\n                <h4>{gettext('You were unsubscribed.')}<br/>\n                    {gettext('Hope to see you again.')}</h4>}\n                {this.state.submitPending && <DoubleBounceSpinner/>}\n                {this._token ? this.renderUnsubscribe() : this.renderForm()}\n                <div className={'promise'}>\n                    {gettext('We promise to never spam you or share your personal information!')}\n                </div>\n            </div>\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// src/apps/landing/containers/subscription.js","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./subscription.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./subscription.less\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./subscription.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/subscription.less\n// module id = 141\n// module chunks = 0","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".subscription {\\n  margin-top: 50px;\\n}\\n.subscription .inputs {\\n  max-width: 500px;\\n  margin-top: 18px;\\n  margin-left: auto;\\n  margin-right: auto;\\n  display: flex;\\n}\\n.subscription .error {\\n  margin-top: 17px;\\n  color: #f57575;\\n}\\n.subscription .promise {\\n  margin-top: 45px;\\n  color: #a1a1a1;\\n}\\n@media screen and (max-width: 767px) {\\n  .subscription .inputs {\\n    flex-direction: column;\\n  }\\n  .subscription .inputs button {\\n    margin-top: 10px;\\n    width: 100%;\\n  }\\n}\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader!./node_modules/less-loader/dist/cjs.js!./src/styles/subscription.less\n// module id = 142\n// module chunks = 0","export function getQueryParams(qs = document.location.search) {\n    qs = qs.split('+').join(' ');\n\n    const params = {};\n    let tokens;\n    const re = /[?&]?([^=]+)=([^&]*)/g;\n\n    while (tokens = re.exec(qs)) {\n        params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n    }\n\n    return params;\n}\n\n\n\n// WEBPACK FOOTER //\n// src/helpers/utils.js"],"mappings":";;;;;;;;AAAA;AACA;;;AAAA;AACA;;;AACA;AACA;AAAA;AACA;;;;;AAEA;;;;;;;;;;;;;;;;ACPA;AACA;AAAA;AACA;;;AAAA;AACA;AAAA;AACA;;;AAAA;AACA;;;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;;;;;;;;;AAEA;;;AACA;AAAA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AAXA;AAYA;AACA;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AAEA;AACA;AACA;AACA;AAHA;AAKA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAGA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AAAA;AAAA;AACA;AADA;AAPA;AAWA;AAAA;AAAA;AACA;AACA;AAFA;AAZA;AAkBA;AA1BA;AAJA;AAkCA;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AADA;AAFA;AAOA;;;AAEA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AADA;AAXA;AAgBA;;;;;;AA5IA;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACPA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}