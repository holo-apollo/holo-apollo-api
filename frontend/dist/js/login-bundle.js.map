{"version":3,"file":"js/login-bundle.js","sources":["webpack:///src/login.js","webpack:///src/apps/users/containers/login.js","webpack:///./src/styles/login_signup.less?84ed","webpack:///./src/styles/login_signup.less"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './axios_defaults';\nimport Login from 'apps/users/containers/login';\n\n\nReactDOM.render(<Login/>, document.getElementById('react-login'));\n\n\n\n// WEBPACK FOOTER //\n// src/login.js","import 'styles/login_signup.less';\nimport React, {Component} from 'react';\nimport {Form, Text} from 'react-form';\nimport autoBind from 'react-autobind';\nimport cx from 'classnames';\n\nimport {Button} from 'common/components/buttons';\nimport {DoubleBounceSpinner} from 'common/components/spinners';\nimport {validateEmail, validatePhone} from 'helpers/validators';\nimport {post} from 'helpers/rest';\n\n\nexport default class Login extends Component {\n    constructor(props) {\n        super(props);\n        autoBind(this);\n        this.state = {\n            submitPending: false,\n            submitError: null\n        };\n    }\n\n    validateError(values) {\n        this.setState({submitError: null});\n        const errors = {\n            username: null,\n            password: null\n        };\n        if (!values.username) {\n            errors.username = gettext('Please type your email or phone.');\n        } else if (!validateEmail(values.username) && !validatePhone(values.username)) {\n            errors.username = gettext('Oops... There\\'s a mistake. Please type a valid email or phone.');\n        }\n        if (!values.password) {\n            errors.password = gettext('Please type your password.');\n        }\n        return errors;\n    }\n\n    onSubmit(values) {\n        this.setState({\n            submitPending: true\n        });\n        post('users/login/', values)\n            .then(() => {\n                window.location = '/';  // TODO: this should be value of 'next' query param\n            }).catch(error => {\n                let message = gettext('Oops! Something went wrong. Please try again in a moment.');\n                if (error.response && error.response.data.detail) {\n                    message = error.response.data.detail;\n                }\n                this.setState({\n                    submitPending: false,\n                    submitError: message\n                });\n            });\n    }\n\n    renderForm() {\n        return (\n            <div className={cx('login-form', {'hidden': this.state.submitPending})}>\n                <Form\n                    onSubmit={this.onSubmit}\n                    validateError={this.validateError}\n                    dontValidateOnMount={true}\n                    validateOnSubmit={true}\n                >\n                    {formApi => {\n                        return (\n                            <form onSubmit={formApi.submitForm}>\n                                <div className={'inputs'}>\n                                    <div className={'error'}>\n                                        {formApi.errors.username}\n                                    </div>\n                                    <Text\n                                        field=\"username\"\n                                        name={'username'}\n                                        className={'grow'}\n                                        placeholder={gettext('Email or phone')}\n                                    />\n                                    <div className={'error'}>\n                                        {formApi.errors.password}\n                                    </div>\n                                    <Text\n                                        field=\"password\"\n                                        type={'password'}\n                                        name={'password'}\n                                        className={'grow'}\n                                        placeholder={gettext('Password')}\n                                    />\n                                    <Button type={'submit'}>\n                                        {gettext('Log in')}\n                                    </Button>\n                                </div>\n                                <div className={'error'}>\n                                    {this.state.submitError}\n                                </div>\n                            </form>\n                        );\n                    }}\n                </Form>\n            </div>\n        );\n    }\n\n    render() {\n        return (\n            <div className={'login-signup'}>\n                <h1>Log in</h1>\n                <div>Don't have an account? <a href=\"/signup/\">Sign up</a></div>\n                {this.state.submitPending && <DoubleBounceSpinner/>}\n                {this.renderForm()}\n            </div>\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// src/apps/users/containers/login.js","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./login_signup.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./login_signup.less\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./login_signup.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/login_signup.less\n// module id = 64\n// module chunks = 1 2","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".login-signup .inputs {\\n  display: flex;\\n  flex-direction: column;\\n}\\n.login-signup .inputs input {\\n  margin-bottom: 10px;\\n}\\n.login-signup .inputs button {\\n  width: 100%;\\n}\\n.login-signup .error {\\n  margin-top: 17px;\\n  color: #f57575;\\n}\\n\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader!./node_modules/less-loader/dist/cjs.js!./src/styles/login_signup.less\n// module id = 65\n// module chunks = 1 2"],"mappings":";;;;;;;;AAAA;AACA;;;AAAA;AACA;;;AACA;AACA;AAAA;AACA;;;;;AAEA;;;;;;;;;;;;;;;;ACPA;AACA;AAAA;AACA;;;AAAA;AACA;AAAA;AACA;;;AAAA;AACA;;;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;;;;;;;;;AAEA;;;AACA;AAAA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AAFA;AAHA;AAOA;AACA;;;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AADA;AAGA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AAJA;AAMA;AAAA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AAAA;AAAA;AACA;AADA;AApBA;AAwBA;AAAA;AAAA;AACA;AADA;AAzBA;AA8BA;AAtCA;AADA;AA2CA;;;AAEA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAJA;AAOA;;;;;;AAtGA;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}